<app-breadcrumb></app-breadcrumb>

<div class="container">
    <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <div class="col-sm-12 offset-md-3 col-md-7 offset-lg-3 col-lg-7 offset-xl-3 col-xl-7 text-left pt-4">
            <h1 *ngIf="this.fromWhere != 'forgot'">
                Change Password
            </h1>
            <h1 *ngIf="this.fromWhere == 'forgot'">
                <!-- Forgot Password -->
                New Patients/Forgot Password
            </h1>
        </div>
        <div class="col-sm-12 offset-md-3 col-md-5 offset-lg-3 col-lg-5 offset-xl-3 col-xl-5 bg-light bgShadowStyle pt-5">
            <form  [formGroup]="form">
                <div class="row">
                    <div class="col-12" *ngIf="this.fromWhere == 'forgot'">
                        <mat-form-field class="example-full-width w-100 " appearance="outline">
                            <mat-label class="text-secondary"> <b>User Id</b> </mat-label>
                            <input type="text" matInput formControlName="userId" readonly>
                            <!-- <mat-error *ngIf="form.get('otp').errors && (form.get('otp').touched || form.get('otp').dirty)">
                                <span *ngIf="form.get('otp').errors.required">{{'errOtpRequired' | l10n}}</span>
                            </mat-error> -->
                            <!-- <i *ngIf="!hideOldPassword" matSuffix (click)="hideOldPassword = !hideOldPassword" class="fa fa-eye eye-icon"></i>
                            <i *ngIf="hideOldPassword" matSuffix (click)="hideOldPassword = !hideOldPassword" class="fa fa-eye-slash eye-icon"></i> -->
                        </mat-form-field>
                    </div>
                    <div class="col-12">
                        <mat-form-field class="example-full-width w-100 " appearance="outline">
                            <mat-label class="text-secondary"> <b>OTP</b> </mat-label>
                            <input type="text" matInput formControlName="otp">
                            <mat-error *ngIf="form.get('otp').errors && (form.get('otp').touched || form.get('otp').dirty)">
                                <span *ngIf="form.get('otp').errors.required">{{'errOtpRequired' | l10n}}</span>
                            </mat-error>
                            <!-- <i *ngIf="!hideOldPassword" matSuffix (click)="hideOldPassword = !hideOldPassword" class="fa fa-eye eye-icon"></i>
                            <i *ngIf="hideOldPassword" matSuffix (click)="hideOldPassword = !hideOldPassword" class="fa fa-eye-slash eye-icon"></i> -->
                        </mat-form-field>
                        <div class="text-right">
                            <a href="javascript:;" (click)="getOtp()">Resend OTP</a>
                        </div>
                    </div>
                    <!-- <div class="col-12">
                        <mat-form-field class="example-full-width w-100 " appearance="outline" [ngbTooltip]="template" clearfix>
                            <mat-label class="text-secondary"> <b>Current / Old Password</b> </mat-label>
                            <input [type]="hideOldPassword? 'password' : 'text'" matInput formControlName="oldPassword">
                            <mat-error *ngIf="form.get('oldPassword').errors && (form.get('oldPassword').touched || form.get('oldPassword').dirty)">
                                <span *ngIf="form.get('oldPassword').errors.required">{{'errPasswordRequired' | l10n}}</span>
                            </mat-error>
                            <i *ngIf="!hideOldPassword" matSuffix (click)="hideOldPassword = !hideOldPassword" class="fa fa-eye eye-icon"></i>
                            <i *ngIf="hideOldPassword" matSuffix (click)="hideOldPassword = !hideOldPassword" class="fa fa-eye-slash eye-icon"></i>
                        </mat-form-field>
                    </div> -->
                </div>
                <div class="row">
                    <div class="col-12">
                        <mat-form-field class="example-full-width w-100 " appearance="outline" [ngbTooltip]="template">
                            <mat-label class="text-secondary"> <b>{{'lblPassword' | l10n}}</b> </mat-label>
                            <input [type]="hidePassword? 'password' : 'text'" matInput formControlName="newPassword">
                            <mat-error *ngIf="form.get('newPassword').errors && (form.get('newPassword').touched || form.get('newPassword').dirty)">
                                <span *ngIf="form.get('newPassword').errors.required">{{'errPasswordRequired' | l10n}}</span>
                                <span *ngIf="form.get('newPassword').errors.maxlength">{{'errPasswordMaxLength' | l10n}}</span>
                                <span *ngIf="!form.get('newPassword').errors.strong && form.get('newPassword').errors.minlength">{{'errPasswordMinLength' | l10n}}</span>
                                <span *ngIf="(!form.get('newPassword').errors.required && !form.get('newPassword').errors.maxlength) && form.get('newPassword').errors.strong">{{'errPasswordPattern' | l10n}}</span>
                            </mat-error>
                            <i *ngIf="!hidePassword" matSuffix (click)="hidePassword = !hidePassword" class="fa fa-eye eye-icon"></i>
                            <i *ngIf="hidePassword" matSuffix (click)="hidePassword = !hidePassword" class="fa fa-eye-slash eye-icon"></i>
                            <!-- <mat-icon matSuffix class="cursorHand" (click)="hidePassword = !hidePassword"> {{hidePassword? 'visibility_off' : 'visibility'}} </mat-icon>                                                 -->
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <mat-form-field class="example-full-width w-100 " appearance="outline" [ngbTooltip]="template">
                            <mat-label class="text-secondary"> <b>{{'lblReEnterPassword' | l10n}}</b> </mat-label>
                            <input [type]="hideReEnterPassword? 'password' : 'text'" matInput  formControlName="confirmPassword" autocomplete="off">
                            <mat-error *ngIf="form.get('confirmPassword').errors && (form.get('confirmPassword').touched || form.get('confirmPassword').dirty)">
                                <span *ngIf="form.get('confirmPassword').errors.required">{{'errPasswordRequired' | l10n}}</span>
                                <span *ngIf="form.get('confirmPassword').errors.passwordMismatch">{{'lblEnterCorrectPass' | l10n}}</span>
                            </mat-error>
                            <i *ngIf="!hideReEnterPassword" matSuffix (click)="hideReEnterPassword = !hideReEnterPassword" class="fa fa-eye eye-icon"></i>
                            <i *ngIf="hideReEnterPassword" matSuffix (click)="hideReEnterPassword = !hideReEnterPassword" class="fa fa-eye-slash eye-icon"></i>
                            <!-- <mat-icon matSuffix class="cursorHand" (click)="hideReEnterPassword = !hideReEnterPassword"> {{hideReEnterPassword? 'visibility_off' : 'visibility'}} </mat-icon> -->
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <div class="row">
                            <div class="col-8 mt-3">
                                <img src="{{captcha}}" alt="Cpacha_Image" width="100%">
                            </div>
                            <div class="col-2 mt-3">
                                <button type="button" (click)="refreshCpacha()" data-toggle="tooltip" title="Refresh" class="btn p-0">
                                    <i class="fa fa-refresh" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <mat-form-field class="example-full-width w-100 " appearance="outline">
                            <mat-label class="text-secondary "> <b>{{'lblEnterCpacha' | l10n}}</b> </mat-label>
                            <input matInput autocomplete="off" formControlName="captcha">
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-xl-12 text-right pb-3">
                        <div class="row">
                            <div class="col-4">
                                <button  *ngIf="this.fromWhere == 'forgot'"  type="reset" class="btn btnColor btn-block" (click)="back()">
                                    Back
                                </button>
                            </div>
                            <div class="col-4">
                                <button type="reset" class="btn btnColor btn-block" (click)="reset()">
                                    Clear
                                </button>
                            </div>
                            <div class="col-4">
                                <button type="submit" class="btn btnColor btn-block" (click)="verifyCaptcha()">
                                    Save
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </div>
</div>

<ng-template #template>
    <div class="row">
        <div class="col-12">
            <p class="ml-1 mb-0 text-left">Note: </p>
            <ul class="passwordNoteList">
                <li>
                    <small>
                        <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                       {{'lblPasswordCondition1' | l10n}}
                    </small>
                </li>
                <li>
                    <small>
                        <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                        {{'lblPasswordCondition2' | l10n}}
                    </small>
                </li>
                <li>
                    <small>
                        <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                        {{'lblPasswordCondition3' | l10n}}
                    </small>
                </li>
                <li>
                    <small>
                        <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                        {{'lblPasswordCondition4' | l10n}}
                    </small>
                </li>
                <li>
                    <small>
                        <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                        {{'lblPasswordCondition5' | l10n}}
                    </small>
                </li>
                <li>
                    <small>
                        <i class="fa fa-dot-circle-o" aria-hidden="true"></i>
                        {{'lblPasswordCondition6' | l10n}}
                    </small>
                </li>
            </ul>
        </div>
    </div>
  </ng-template>